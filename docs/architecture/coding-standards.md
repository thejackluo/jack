# Coding Standards

## Purpose
These standards codify how we write Astro, TypeScript, and Markdown inside the `website/` modernization so that future stories deliver consistent, maintainable output. They supplement the architectural guidance in `docs/architecture.md`.

## Language & Syntax
- **TypeScript first:** use `.ts`/`.tsx` (or `.astro` script blocks with `lang="ts"`) and enable strict typing. Prefer explicit interfaces for content-derived data.
- **Modern JavaScript:** target ES2022 features available in Node 18+. Avoid legacy patterns (e.g., `var`, manual prototype manipulation).
- **Astro components:** keep frontmatter scripts minimal and export helper utilities from separate `.ts` modules when they grow beyond setup-only code.
- **Markdown:** honor MDX-style fenced code, heading hierarchy (`#` once per page), and keep frontmatter keys ordered: `title`, `publishDate`, `tags`, `excerpt`, `heroImage`, `externalUrl`.

## Formatting
- Follow Prettier-style defaults (2-space indent, trailing commas where valid, single quotes in Markdown frontmatter). The repo relies on IDE formatting; run `npm run validate:content` before committing to surface syntax/typing issues.
- Limit lines to ~100 characters for readability. Break long attribute lists across lines.
- Use descriptive naming: components `PascalCase`, utilities `camelCase`, constants `SCREAMING_SNAKE_CASE`.

## Imports & Modules
- Use module-relative aliases only if defined in `tsconfig.json`; otherwise prefer relative paths to keep Astro/Vitest resolution straightforward.
- Group imports: Astro/Node built-ins, third-party, then local modules. Leave a blank line between groups.
- Re-export shared utilities through index files only when multiple consumers exist.

## Components & Pages
- Keep render logic declarative. For interactivity, extract an Astro island (`.astro` or `.tsx`) and hydrate with the lightest client directive that satisfies the task (`client:visible` > `client:idle` > `client:load`).
- Ensure interactive components expose accessibility affordances (ARIA labels, keyboard handlers). Reuse shared styles from `src/styles/` or `public/assets/css/` instead of duplicating inline CSS.
- Co-locate component-specific tests under `src/components/__tests__/` using the `.test.ts` suffix.

## Error Handling & Logging
- Prefer returning typed fallbacks instead of throwing inside Astro frontmatter; log issues using `console.error` only when action required. Analytics events should guard against missing browser APIs before firing.

## Documentation & Comments
- Add TODO comments only when paired with a follow-up story ID. Use short, high-signal comments that explain _why_ the code exists, not _what_ it does.
- Update relevant docs (README, authoring guides) whenever new workflows or config flags are introduced.

## Validation
- Treat `npm run build`, `npm run validate:content`, and the Vitest/Playwright suites as mandatory before marking a story ready. Capture command outputs in the story Dev Agent Record.
- Ensure Markdown generated by scripts (`npm run new:blog`) remains lint-free; rerun the generator after template updates.
